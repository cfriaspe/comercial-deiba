<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Filtros | Comercial Deiba SpA</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Estilos -->
  <link rel="stylesheet" href="style.css">
</head>

<body>

<!-- ========================================================= -->
<!-- üöÄ NAVBAR -->
<!-- ========================================================= -->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top nav-deiba">
  <div class="container">

    <a class="navbar-brand d-flex align-items-center" href="index.html">
      <img src="img/logo.png" alt="Deiba Logo" class="logo-deiba me-2">
    </a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse justify-content-center" id="navbarNav">

      <!-- Carrito -->
      <li class="nav-item ms-3 position-relative">
        <a href="carrito.html" class="nav-link">
          <i class="bi bi-cart3 fs-4"></i>
          <span id="contadorCarrito"
                class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-warning text-dark"
                style="font-size: 0.7rem;">0</span>
        </a>
      </li>

      <ul class="navbar-nav">
        <li class="nav-item"><a class="nav-link" href="index.html#hero">Inicio</a></li>
        <li class="nav-item"><a class="nav-link" href="sobre nosotros.html">Sobre Nosotros</a></li>
        <li class="nav-item"><a class="nav-link active" href="#">Filtros</a></li>
        <li class="nav-item"><a class="nav-link" href="index.html#contacto">Contacto</a></li>
      </ul>
    </div>
  </div>
</nav>

<!-- ========================================================= -->
<!-- üß∞ SECCI√ìN FILTROS -->
<!-- ========================================================= -->
<section class="py-5 text-center text-white" style="margin-top: 90px;">
  <div class="container">
    <h2 class="fw-bold mb-4">Filtros</h2>
    <p class="mb-4">Cat√°logo de filtros de aire, aceite y combustible.</p>

    <div class="row g-4" id="lista-filtros"></div>
  </div>
</section>

<!-- ========================================================= -->
<!-- üìç FOOTER -->
<!-- ========================================================= -->
<footer class="footer-deiba text-center text-white py-4">
  <div class="container">

    <p class="fw-bold mb-1">Comercial Deiba SPA</p>
    <p class="mb-1">üìû Tel: <a href="tel:+56974790692" class="contact-link">+56 9 7479 0692</a></p>
    <p class="mb-1">‚úâÔ∏è <a href="mailto:comercialdeiba@gmail.com" class="contact-link">comercialdeiba@gmail.com</a></p>
    <p class="mb-3">üìç Parque Isidora 908, Bodega 308B ‚Äî Pudahuel, Santiago</p>

    <div class="social-icons">
      <a href="https://www.instagram.com/comercialdeibaspa/" target="_blank" class="social-link">
        <i class="bi bi-instagram"></i>
      </a>
    </div>

    <p class="mt-3 small text-secondary">
      ¬© 2025 Comercial Deiba SpA ‚Äî Todos los derechos reservados
    </p>
  </div>
</footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- ========================================================= -->
<!-- üß† CARGAR FILTROS.JSON -->
<!-- ========================================================= -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  const contenedor = document.getElementById("lista-filtros");

  fetch("filtros.json")
    .then(response => response.json())
    .then(productos => {
      productos.forEach(prod => {

        const col = document.createElement("div");
        col.className = "col-md-4";

        col.innerHTML = `
          <div class="product h-100">

            <img src="${prod.imagen}" alt="${prod.nombre}" class="product-img">

            <div class="product-body">
              <h5 class="fw-bold">${prod.nombre}</h5>
              <p>${prod.descripcion}</p>
              <p class="fw-bold">$ ${prod.precio.toLocaleString("es-CL")}</p>

               ${prod.oferta ? `
                  <div class="promo-box mt-2">
                    <p class="promo-title">‚ú® ¬°Aprovecha nuestra promoci√≥n especial!</p>
                    <p class="promo-text">
                      Agrega 2 o m√°s unidades de este producto a tu carrito y obt√©n un descuento exclusivo.
                      <br><span class="promo-footnote">*El descuento se aplicar√° autom√°ticamente y se ver√° reflejado en tu carrito.</span>
                    </p>
                  </div>
              ` : ''}
            </div>

            <button class="btn-producto"
              onclick="agregarAlCarrito(${prod.id}, '${prod.nombre}', ${prod.precio}, '${prod.imagen}', ${prod.oferta}, ${prod.descuento || 0})">
              Agregar al carrito üõí
            </button>

          </div>
        `;


        contenedor.appendChild(col);

      });
    })
    .catch(error => {
      contenedor.innerHTML = "<p>No se pudieron cargar los productos.</p>";
    });
});
</script>

<!-- ========================================================= -->
<!-- üõí CARRITO -->
<!-- ========================================================= -->
<script>
function agregarAlCarrito(id, nombre, precio, imagen, oferta = false, descuento = 0) {

  let carrito = JSON.parse(localStorage.getItem("carrito")) || [];

  let existente = carrito.find(item => item.id === id);

  if (existente) {
    existente.cantidad += 1;
  } else {
    carrito.push({
      id,
      nombre,
      precio,
      imagen,
      cantidad: 1,
      oferta: oferta,
      descuento: descuento   // üëà ahora s√≠ queda guardado el % en el carrito
    });
  }

  localStorage.setItem("carrito", JSON.stringify(carrito));
  actualizarContadorCarrito();
  alert("Producto agregado al carrito ‚úîÔ∏è");
}

</script>

<script>
function actualizarContadorCarrito() {
  let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
  let total = carrito.reduce((s, p) => s + p.cantidad, 0);

  const badge = document.getElementById("contadorCarrito");
  if (badge) badge.innerText = total;
}

document.addEventListener("DOMContentLoaded", actualizarContadorCarrito);
</script>

</body>
</html>
